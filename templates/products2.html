<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EcoFinds - Sustainable Shopping</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='products.css') }}"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Hamburger Menu System -->
    <div class="main_box">
      <input type="checkbox" id="check" />
      <!-- Inside .sidebar_menu -->
      <div class="sidebar_menu">
        <div class="logo">
          <a href="{{ url_for('home') }}">EcoFinds</a>
        </div>
        <div class="menu">
          <ul>
            <li>
              <a href="{{ url_for('home') }}">
                <i class="fa fa-home"></i> Home</a>
            </li>
            <li>
              <a href="{{ url_for('search') }}"
                ><i class="fa fa-search"></i> Search</a
              >
            </li>
            {% if current_user.is_authenticated %}
            <li>
              <a href="{{ url_for('profile') }}"
                ><i class="fa fa-user"></i> Profile</a
              >
            </li>
            <li>
              <a href="{{ url_for('cart') }}"
                ><i class="fa fa-shopping-cart"></i> Cart</a
              >
            </li>
            <li>
              <a href="{{ url_for('logout') }}"
                ><i class="fa fa-sign-out-alt"></i> Logout</a
              >
            </li>
            {% else %}
            <li>
              <a href="{{ url_for('login') }}"
                ><i class="fa fa-sign-in-alt"></i> Login</a
              >
            </li>
            <li>
              <a href="{{ url_for('register') }}"
                ><i class="fa fa-user-plus"></i> Register</a
              >
            </li>
            {% endif %}
          </ul>
        </div>
      </div>
    </div>

    <!-- Fixed Header -->
    <div class="header-container">
      <div class="header">
        <div class="header-left">
          <div class="btn_one">
            <label for="check">
              <i class="fa-solid fa-bars"></i>
            </label>
          </div>
          <div>
            <a href="{{ url_for('home') }}" style="text-decoration: none; color: #e5a12e"
              ><h1>EcoFinds</h1></a
            >
          </div>
          <a
            href="{{ url_for('search') }}"
            class="header-link"
            style="text-decoration: none; color: #e5a12e;"
            >Search</a
          >
          <a
            href="{{ url_for('home') }}"
            class="header-link"
            style="text-decoration: none; color: #e5a12e;"
            >Products</a
          >
        </div>
        <div class="header-right">
          {% if current_user.is_authenticated %}
          <a href="{{ url_for('profile') }}">Welcome, {{ current_user.username }}</a>
          <a href="{{ url_for('add_product') }}">Add Product</a>
          <a href="{{ url_for('cart') }}">Cart</a>
          <a href="{{ url_for('logout') }}">Logout</a>
          {% else %}
          <a
            href="{{ url_for('login') }}"
            style="text-decoration: none; color: #e5a12e"
            >Login</a
          >

          <a href="{{ url_for('register') }}" style="text-decoration: none; color: #e5a12e""
            >Register</a
          >
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Main Content Container -->
    <div class="container">
      <!-- Search Bar -->
      <div class="search-container">
        <form method="get" action="{{ url_for('search') }}">
          <i class="fa-solid fa-magnifying-glass search-icon"></i>
          <input
            type="text"
            class="search-bar"
            name="q"
            placeholder="Search for eco-friendly products..."
            value="{{ search_query|default('') }}"
          />
          <button type="submit" style="display: none"></button>
        </form>
      </div>

      <!-- Filter Section -->
      <div class="filter-section">
        <button class="filter-btn" onclick="toggleFilter()">
          <i class="fa-solid fa-filter"></i>Filter
        </button>
        <div class="filter-dropdown" id="filterDropdown">
          <form method="get" action="{{ url_for('search') }}">
            <div class="filter-item">
              <input
                type="checkbox"
                name="category"
                value="Clothing and Accessories"
                id="clothing"
              />
              <label for="clothing"
                ><i class="fa-solid fa-tshirt"></i>Clothing and
                Accessories</label
              >
            </div>
            <div class="filter-item">
              <input
                type="checkbox"
                name="category"
                value="Electronics"
                id="electronics"
              />
              <label for="electronics"
                ><i class="fa-solid fa-laptop"></i>Electronics</label
              >
            </div>
            <div class="filter-item">
              <input
                type="checkbox"
                name="category"
                value="Books and Stationary"
                id="books"
              />
              <label for="books"
                ><i class="fa-solid fa-book"></i>Books and Stationary</label
              >
            </div>
            <div class="filter-item">
              <input
                type="checkbox"
                name="category"
                value="Furniture and Home Decor"
                id="furniture"
              />
              <label for="furniture"
                ><i class="fa-solid fa-couch"></i>Furniture and Home
                Decor</label
              >
            </div>
            <button type="submit">Apply Filter</button>
          </form>
        </div>
      </div>

      <!-- Hero Banner Carousel -->
      <div class="carousel">
        <div class="carousel-inner" id="carouselInner">
          <div class="carousel-item">
            <img
              src="https://images.unsplash.com/photo-1558769132-cb1aea458c5e?w=800&h=400&fit=crop&crop=center"
              alt="Sustainable Fashion"
              class="carousel-image"
            />
            <div class="carousel-overlay">
              <a href="{{ url_for('home') }}" class="cta-button">Shop Now</a>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=800&h=400&fit=crop&crop=center"
              alt="Eco-friendly Products"
              class="carousel-image"
            />
            <div class="carousel-overlay">
              <a href="{{ url_for('home') }}" class="cta-button">Shop Now</a>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="https://images.unsplash.com/photo-1472851294608-062f824d29cc?w=800&h=400&fit=crop&crop=center"
              alt="Green Living"
              class="carousel-image"
            />
            <div class="carousel-overlay">
              <a href="{{ url_for('home') }}" class="cta-button">Shop Now</a>
            </div>
          </div>
          <div class="carousel-item">
            <img
              src="https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?w=800&h=400&fit=crop&crop=center"
              alt="Organic Products"
              class="carousel-image"
            />
            <div class="carousel-overlay">
              <a href="{{ url_for('home') }}" class="cta-button">Shop Now</a>
            </div>
          </div>
        </div>
        <button class="carousel-ctrl carousel-prev" onclick="moveCarousel(-1)">
          <i class="fa-solid fa-chevron-left"></i>
        </button>
        <button class="carousel-ctrl carousel-next" onclick="moveCarousel(1)">
          <i class="fa-solid fa-chevron-right"></i>
        </button>
      </div>

      <!-- Categories Section -->
      <div class="section-title">
        <i class="fa-solid fa-tags"></i>Available Products
      </div>

      <div class="categories-grid">
        {% if products %} {% for product in products %}
        <div class="category-card">
          <div class="category-image">
            <img
              src="{{ product.image_url }}"
              alt="{{ product.title }}"
              style="width: 100px; height: 100px; object-fit: cover"
            />
          </div>
          <div class="category-title">{{ product.title }}</div>
          <div class="category-price">â‚¹{{ product.price }}</div>
          <a
            href="{{ url_for('product_details', product_id=product.id) }}"
            class="view-btn"
            >View</a
          >
          {% if current_user.is_authenticated %}
          <a
            href="{{ url_for('add_to_cart', product_id=product.id) }}"
            class="cart-btn"
            >Add to Cart</a
          >
          {% endif %}
        </div>
        {% endfor %} {% else %}
        <p>No products found.</p>
        {% endif %}
      </div>
    </div>

    <script>
      let currentSlide = 0;
      const totalSlides = 4;

      // Auto-play carousel
      function autoPlay() {
        currentSlide = (currentSlide + 1) % totalSlides;
        updateCarousel();
      }

      // Set interval for auto-play
      let autoPlayInterval = setInterval(autoPlay, 4000);

      function moveCarousel(direction) {
        clearInterval(autoPlayInterval);

        currentSlide += direction;
        if (currentSlide < 0) currentSlide = totalSlides - 1;
        if (currentSlide >= totalSlides) currentSlide = 0;

        updateCarousel();

        setTimeout(() => {
          autoPlayInterval = setInterval(autoPlay, 4000);
        }, 5000);
      }

      function setCarouselSlide(index) {
        clearInterval(autoPlayInterval);
        currentSlide = index;
        updateCarousel();

        setTimeout(() => {
          autoPlayInterval = setInterval(autoPlay, 4000);
        }, 5000);
      }

      function updateCarousel() {
        const carouselInner = document.getElementById("carouselInner");
        const indicators = document.querySelectorAll(".carousel-indicator");

        carouselInner.style.transform = `translateX(-${currentSlide * 100}%)`;

        indicators.forEach((indicator, index) => {
          indicator.classList.toggle("active", index === currentSlide);
        });
      }

      function toggleFilter() {
        const filterDropdown = document.getElementById("filterDropdown");
        filterDropdown.classList.toggle("active");
      }

      function selectFilter(category) {
        console.log("Selected filter:", category);
        const filterDropdown = document.getElementById("filterDropdown");
        filterDropdown.classList.remove("active");
      }

      function toggleProfile() {
        const profileDropdown = document.querySelector(".profile-dropdown");
        profileDropdown.classList.toggle("active");
      }

      function navigateTo(page) {
        console.log("Navigating to:", page);
      }

      // Close dropdowns when clicking outside
      document.addEventListener("click", function (event) {
        const filterSection = document.querySelector(".filter-section");
        const profileSection = document.querySelector(".profile");

        if (!filterSection.contains(event.target)) {
          document.getElementById("filterDropdown").classList.remove("active");
        }

        if (!profileSection.contains(event.target)) {
          document
            .querySelector(".profile-dropdown")
            .classList.remove("active");
        }
      });
    </script>
  </body>
</html>
